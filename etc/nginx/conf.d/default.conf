server {
	#listen 80;
	#server_name localhost;
	
 	listen 443 ssl http2 default_server;
	listen [::]:443 ssl http2 default_server;

	root /usr/share/nginx/html;

	# Self signed certificates generated by the ssl-cert package
	# Don't use them in a production server!
	ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;
	ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;

    #charset koi8-r;
    #access_log  /var/log/nginx/host.access.log  main;
	
    location / {
		# 1/2 hora
		add_header Cache-Control "public, max-age=1800";
		root /usr/share/nginx/html;
		index  index.html;
    }

	location /index.html {
		add_header Cache-Control "no-cache, no-store, must-revalidate";
	}

	location /api/ {
		proxy_set_header service "ALTAMIRA";
		proxy_set_header client-dns "tiendaonline.orange.es";
		
		# 5 mins
		add_header Cache-Control "public, max-age=300";
		
		# requiere env https_proxy
		proxy_pass https://api-uat.int.si.orange.es/public/;
	}
	
	location /clientes/api/ {
		#proxy_set_header x-wassup-cred-used "656586088";
		#proxy_set_header x-wassup-credtype-used "MSISDN";
		#proxy_set_header x-wassup-lra "MassMarketMobileUser,MassMarketFixUser";
		#proxy_set_header x-wassup-pa1 "NIF";
		#proxy_set_header x-wassup-pa2 "05422521H";
		#proxy_set_header x-wassup-saltoid "656586088";
		#proxy_set_header service "ENDOR";
		#proxy_set_header client-dns "ecare-uat.int.si.orange.es";
		
		proxy_set_header OAM_TIENE_PERFIL "cn=DEMO,ou=FICHA_DE_CLIENTE,ou=Web,ou=Perfiles,o=amena.es, ou=ALTAIR"; 
        proxy_set_header OAM_REMOTE_USER "jiglesias"; 
        proxy_set_header X-FORWARDED-SERVER "fichadecliente-uat.int.si.orange.es"; 
        proxy_set_header OAM_SFID "40";
		
		
		# 30 segs
		add_header Cache-Control "private, max-age=30";
		
		# requiere env https_proxy
		proxy_pass https://api-uat.int.si.orange.es/daf2/;
	}
	
    #error_page  404              /404.html;
    # redirect server error pages to the static page /50x.html
    #
    #error_page   500 502 503 504  /50x.html;
    #location = /50x.html {
    #    root   /usr/share/nginx/html;
    #}

}
